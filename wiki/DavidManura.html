<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>lua-users wiki: David Manura</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../styles/main.css">
</HEAD>
<BODY ><table width="100%" border="0"> <tr><td align=left width="100%"><h1><a href="/cgi-bin/wiki.pl?action=search&amp;string=DavidManura&amp;body=1" title="List pages referring to DavidManura">David Manura</a></h1></td><td align=right>
    <table cellpadding="0" cellspacing="0" border="0" width="1%">
      <tbody>
        <tr>
            <td><a href="../index.html">
            <img src="../images/nav-logo.png" alt="lua-users home" width="177" height="40" border="0"></a></td>
        </tr>
        <tr>
            <td>
            <table cellpadding="0" cellspacing="0" border="0" width="100%">
                <tbody>
                <tr>
                    <td><img src="../images/nav-elbow.png" alt="" width="48" height="40"></td>
                    <td nowrap valign="middle" width="100%">
                        <a href="../wiki/index.html" class="nav">wiki</a></td>
                </tr>
                </tbody>
            </table>
            </td>
        </tr>
      </tbody>
    </table>
<form method="post" action="../wiki/FindPage.html" enctype="application/x-www-form-urlencoded" style="display:inline; margin:0;">
<input type="hidden" name="action" value="search"  /><input type="text" name="string"  size="20" style="" id="search_query1" /><input type="hidden" name="title" value="1"  /><input type="submit" name=".submit" value="Search" /><input type="hidden" name="body" value="on"  /></form></td></tr> </table>
<br clear=all>
<H2>Wiki pages</H2>
<p>
There are Lua wiki pages and projects I've been involved in.
<p>
Code and Projects:
<p>
<UL>
<li> Formal Lua modules (core):
<UL>
<li> <a href="https://github.com/davidm/lua-file-slurp">[lua-file-slurp / file_slurp]</a> - Easily read/write entire files or pipes from/to a string
<li> <a href="https://github.com/davidm/lua-require-any">[lua-require-any / requireany]</a> - require any one of the listed modules
<li> <a href="https://github.com/davidm/lua-glob-pattern">[lua-glob-pattern / globtopattern]</a> -  Convert file glob to Lua string pattern - <a href="../wiki/FileGlob.html" >FileGlob</a>
<li> <a href="https://github.com/davidm/lua-find-bin">[lua-find-bin / findbin]</a> - Locate directory of original perl script
<li> <a href="https://github.com/davidm/lua-lib">[lua-lib / lib]</a> - Simple insertion of directories in package search paths
<li> <a href="https://github.com/davidm/lua-compat-env">[lua-compat-env / compat_env]</a> - Lua 5.1/5.2 environment compatibility functions (load/loadfile/getfenv/setfenv)
</UL>
<li> Formal Lua modules (more):
<UL>
<li> <a href="https://github.com/davidm/lua-bit-numberlua">[lua-bit-numberlua / bit.numberlua]</a> - Bitwise operators in pure Lua using Lua numbers.  Includes Lua 5.2 'bit32' and (LuaJIT) Lua<code></code>Bit<code></code>Op 'bit' compatibility interfaces.
<li> <a href="https://github.com/davidm/lua-digest-crc32lua">[lua-digest-crc32lua / digest.crc32lua]</a> - CRC-32 checksum implemented in pure Lua - [dependencies: bit.numberlua (or native bit library)]
<li> <a href="https://github.com/davidm/lua-pythonic-optparse">[lua-pythonic-optparse / pythonic.optparse]</a> - Command-line argument parsing similar to Python's optparse library
<li> <a href="https://github.com/davidm/lua-compress-deflatelua">[lua-compress-deflatelua / compress.deflatelua]</a> - DEFLATE (RFC1951)/gunzip implemented in pure Lua - <a href="../wiki/ModuleCompressDeflateLua.html" >ModuleCompressDeflateLua</a> - [dependencies: bit.numberlua (or native bit library), digest.crc32 (optional), and pythonic.optparse (optional)]
<li> <a href="https://gist.github.com/1422205">[lua-sourcepack / sourcepack]</a> - Extract Lua files from other Lua files.
<li> <a href="https://github.com/davidm/lua-balanced">[luabalanced]</a> - match delimited snippets of Lua code in a string - <a href="../wiki/LuaBalanced.html" >LuaBalanced</a>
<li> <a href="https://github.com/davidm/lua-stringlua">[lua-stringlua / stringlua]</a> - Lua 5.1 string library reimplemented in Lua - <a href="../wiki/StringLibraryInLua.html" >StringLibraryInLua</a>
<li> <a href="https://github.com/davidm/lua-list-comprehension">[comprehension]</a> - pure Lua implementation of List comprehensions via dynamic code gen - <a href="../wiki/ListComprehensions.html" >ListComprehensions</a>
<li> <a href="https://github.com/davidm/lua-matrix">[lua-matrix / matrix]</a> - Matrices and vectors of are real, complex, and symbolic elements, implemented as Lua tables - <a href="../wiki/LuaMatrix.html" >LuaMatrix</a> (maintenance)
<li> <a href="../wiki/LuaCom.html" >LuaCom</a> - Lua interface to Microsoft's Component Object Model (COM) (maintenance)
<li> <a href="https://github.com/davidm/lua-mbuild">[lua-mbuild]</a> - Lua-implementation of a memoized build system (like fabricate, memoize.py, fbuild, etc.) <a href="../wiki/LuaBuildSystems.html" >LuaBuildSystems</a>
<li> <a href="https://gist.github.com/davidm/5125764">[makebuild.lua]</a> - rudimentary Lua makefile generator in &lt; 100 lines of code. <a href="../wiki/LuaBuildSystems.html" >LuaBuildSystems</a>
</UL>
<li> <a href="../wiki/LuaToCee.html" >LuaToCee</a> - convert Lua to C code using C API calls
<li> <a href="../wiki/InlineCee.html" >InlineCee</a> - simple module that allows C code to be embedded inline in Lua code.
<li> <a href="../wiki/LuaDist.html" >LuaDist</a> - CMake-based ports system for Lua and non-Lua packages.
<li> <a href="../wiki/LuaFish.html" >LuaFish</a> - Lua 5.1 parser, macro system, and static type checker in LPeg <a href="http://www.inf.puc-rio.br/~roberto/lpeg.html">[1]</a> (related to Metalua <a href="http://metalua.luaforge.net/">[2]</a>)
<li> <a href="../wiki/LuaSearch.html" >LuaSearch</a> - effort to standardize Lua module documenation via POD
<li> <a href="../wiki/ModuleReview.html" >ModuleReview</a> - effort to review/classify modules in terms of quality and usefulness for Lua distributions
<li> <a href="../wiki/SlightlyLessSimpleLuaPreprocessor.html" >SlightlyLessSimpleLuaPreprocessor</a> - enhanced version of the enhanced version of the Lua preprocessor
<li> <a href="../wiki/LuaProxyDll.html" >LuaProxyDll</a> - avoid DLL dependency issue
<li> <a href="../wiki/DetectingUndefinedVariables.html" >DetectingUndefinedVariables</a> - <code>checkglobals</code> function is an alternative to <code>etc/strict.lua</code> and <code>luac -p -l - | lua test/globals.lua</code>.
<li> <a href="../wiki/LuaGenPlusPlus.html" >LuaGenPlusPlus</a> - A C++ header file to generate efficient sequences of Lua C API calls at compile-time via template metaprogramming techniques.
<li> <a href="../wiki/LuaInterpreterInLua.html" >LuaInterpreterInLua</a> - reimplements the Lua 5.1 interpreter (lua.c) in Lua. 
<li> <a href="../wiki/CommandLineParsing.html" >CommandLineParsing</a> - command line parsing (getopt)
<li> <a href="../wiki/LuaPatch.html" >LuaPatch</a> - Lua implementation of the patch utility
<li> <a href="../wiki/ExPattern.html" >ExPattern</a> - regular-expression like support implemented in terms of Lua patterns and code generation
<li> <a href="../wiki/SerialCommunication.html" >SerialCommunication</a> - serial communications in Lua/alien
<li> <a href="../wiki/SourceOptimizer.html" >SourceOptimizer</a> -- utility for optimizing Lua source, inlining functions
<li> <a href="../wiki/StringQuery.html" >StringQuery</a> - string pattern matching and replacement library inspired somewhat by jQuery
<li> <a href="../wiki/LuaAnnotate.html" >LuaAnnotate</a> - C code comments externally stored but displayed inline.
</UL>
<p>
General Topics, Patterns, Tricks, and Design:
<p>
<UL>
<li> <a href="../wiki/LuaNews.html" >LuaNews</a> - A summary of the latest happenings on the Lua mail list and elsewhere in the Lua world.
<li> <a href="../wiki/LuaStyleGuide.html" >LuaStyleGuide</a> - every language has a style guide(s)
<li> <a href="../wiki/LuaModuleFunctionCritiqued.html" >LuaModuleFunctionCritiqued</a> - please don't use the <code>module</code> function
<li> <a href="../wiki/ModuleExecutionProposal.html" >ModuleExecutionProposal</a> - proposal+patch to add a new Lua command-line switch to load a function with a given package name and execute it as a script
<li> <a href="../wiki/ModuleDefinition.html" >ModuleDefinition</a> - various ways to define modules
<li> <a href="../wiki/ModuleVersioning.html" >ModuleVersioning</a> - module versioning discussion
<li> <a href="../wiki/LoadLibrary.html" >LoadLibrary</a> - discussion of issues with Win32 Load<code></code>Library module loading
<li> <a href="../wiki/ApplicationBinaryInterface.html" >ApplicationBinaryInterface</a> - notes on binary interface (ABI) compatibility in Lua modules
<li> <a href="../wiki/BuildingModules.html" >BuildingModules</a> - (section on avoiding/mixing C runtimes)
<li> <a href="../wiki/LuaLocales.html" >LuaLocales</a> - notes on locales in Lua
<li> <a href="../wiki/NamedParameters.html" >NamedParameters</a> - named parameter support in Lua
<li> <a href="../wiki/MetaLuaRecipes.html" >MetaLuaRecipes</a> - Metalua syntax extensions
<li> <a href="../wiki/ResourceAcquisitionIsInitialization.html" >ResourceAcquisitionIsInitialization</a> - RAII is poorly supported in Lua
<li> <a href="../wiki/StatementsInExpressions.html" >StatementsInExpressions</a> - relating to Lua statements cannot be used inside expressions without anonymous functions
<li> <a href="../wiki/ExpressionsAsStatements.html" >ExpressionsAsStatements</a> - Lua expressions are not statements, though we can simulate the effect.
<li> <a href="../wiki/VarargTheSecondClassCitizen.html" >VarargTheSecondClassCitizen</a> - relating to varargs not being first class objects limits expression
<li> <a href="../wiki/MutableFunctions.html" >MutableFunctions</a> - demonstration that closures can implement the semantics of Lua tables without using any Lua tables (functional programming)
<li> <a href="../wiki/FunctionalTuples.html" >FunctionalTuples</a> - a code generation approach to implementing tuples of length N
<li> <a href="../wiki/LuaVersusPerl.html" >LuaVersusPerl</a> - Lua and Perl have different applications
<li> <a href="../wiki/LunaticPython.html" >LunaticPython</a> - call Python from Lua
<li> <a href="../wiki/ErrorHandlingBetweenLuaAndCplusplus.html" >ErrorHandlingBetweenLuaAndCplusplus</a> - issues in mixing Lua with C++ rather than C
<li> <a href="../wiki/SourcePreprocessing.html" >SourcePreprocessing</a> - transforming source code before execution
<li> <a href="../wiki/LuaDataFormats.html" >LuaDataFormats</a> - Lua as a data representation language
<li> <a href="../wiki/CppMetaprogramming.html" >CppMetaprogramming</a> - metaprogramming C++ not with templates or macros but with Lua.
<li> <a href="../wiki/MakingLuaLikeRuby.html" >MakingLuaLikeRuby</a> - Rubyesque Lua.
<li> <a href="../wiki/GeneralizedPairsAndIpairs.html" >GeneralizedPairsAndIpairs</a> - why can't a table pretend to be another table?
<li> <a href="../wiki/SandBoxes.html" >SandBoxes</a> - issues relating to sandboxing: running untrusted Lua code in a restricted Lua environment
<li> <a href="../wiki/LuaDesignPatterns.html" >LuaDesignPatterns</a> - Lua design patterns
<li> <a href="../wiki/LuaHacks.html" >LuaHacks</a> - novel things you shouldn't do but could
<li> <a href="../wiki/DecoratorsAndDocstrings.html" >DecoratorsAndDocstrings</a> - associate metadata or help with an object
<li> <a href="../wiki/CustomOperators.html" >CustomOperators</a> - simulating support for custom operators
<li> <a href="../wiki/ImmutableObjects.html" >ImmutableObjects</a> - topics of immutability in Lua
<li> <a href="../wiki/StoringNilsInTables.html" >StoringNilsInTables</a> - topics relating to <code>nil</code> not being explicitly stored in tables
</UL>
<p>
<UL>
<li> <a href="../wiki/ShortAnonymousFunctions.html" >ShortAnonymousFunctions</a> - making <code>function() ... end</code> less verbose
<li> <a href="../wiki/LuaTypeChecking.html" >LuaTypeChecking</a> - approaches to type checking in Lua, a dynamically typed language
<li> <a href="../wiki/ReadOnlyTables.html" >ReadOnlyTables</a> - preventing writes to Lua tables.
<li> <a href="../wiki/StringInterpolation.html" >StringInterpolation</a> - placing variables inline to strings, like Perl "x = $x"
<li> <a href="../wiki/ColonForMethodCall.html" >ColonForMethodCall</a> - concerning the distinction in Lua of <code>o:f()</code> v.s. <code>o.f()</code>
<li> <a href="../wiki/ObjectProperties.html" >ObjectProperties</a> - getters/setters that look like table field accesses
<li> <a href="../wiki/LuaCarp.html" >LuaCarp</a> - Perl Carp implemented in Lua (handle error level transparently)
<li> <a href="../wiki/AssociativityOfConcatenation.html" >AssociativityOfConcatenation</a> - discussions related to concatenation being right associative
<li> <a href="../wiki/TernaryOperator.html" >TernaryOperator</a> - addressing the lack of a C-like ternary conditional operator (a?b:c) in Lua
<li> <a href="../wiki/TableScope.html" >TableScope</a> - solutions (and patch) to allow table constructs to enclose a scope
<li> <a href="../wiki/CnumberPatch.html" >CnumberPatch</a> - fast implementation of getter/setter handler functions for locals - Lua patch.
<li> <a href="../wiki/SimdExperiment.html" >SimdExperiment</a> - experimental patch to Lua VM to support a type of Single Instruction Multiple Data (SIMD)
<li> <a href="../wiki/PortableNetworkGraphicsParser.html" >PortableNetworkGraphicsParser</a> - partial PNG graphics file parser (example) 
<li> <a href="../wiki/TheEssenceOfLoadingCode.html" >TheEssenceOfLoadingCode</a> - explains the relationship between the various ways of loading external code in Lua.
<li> <a href="../wiki/ExpressionTemplatesInLua.html" >ExpressionTemplatesInLua</a> - a Lua coding technique similar to C++ expression templates
<li> <a href="../wiki/OutputLuaTableToHtmlFile.html" >OutputLuaTableToHtmlFile</a> - Lua table to HTML/CSS with expand/contract and xref links
<li> <a href="../wiki/RuntimeSyntax.html" >RuntimeSyntax</a> - automates the run-time simulation of what resembles syntax extensions
<li> <a href="../wiki/MethodChainingWrapper.html" >MethodChainingWrapper</a> - cooperatively add custom methods to built-in types like strings and functions, particularly when using method chaining
<li> <a href="../wiki/TablePreallocation.html" >TablePreallocation</a> - methods to preallocate tables from Lua
<li> <a href="../wiki/SleepFunction.html" >SleepFunction</a> - pause for N seconds
<li> <a href="../wiki/GettingVariablesFromValues.html" >GettingVariablesFromValues</a> - pass-by-reference and the like for Lua
<li> <a href="../wiki/StringTrim.html" >StringTrim</a> - comparison of string trim operations
<li> <a href="../wiki/LuaInspect.html" >LuaInspect</a> - Lua code analysis and HTML code browsing
<li> <a href="../wiki/PcallAndCoroutines.html" >PcallAndCoroutines</a> - implement pcall in terms of coroutines
<li> <a href="../wiki/LocalsVsGlobals.html" >LocalsVsGlobals</a> - Comparison between local and global variables
<li> <a href="../wiki/ProgramAnalysis.html" >ProgramAnalysis</a> - static code analysis or dynamic program analysis) of Lua code
<li> <a href="../wiki/LuaImplementationVerification.html" >LuaImplementationVerification</a> - validating correctness of Lua implementations
<li> <a href="../wiki/FileSystemOperations.html" >FileSystemOperations</a> - file system operations libraries for Lua
<li> <a href="../wiki/LightUserData.html" >LightUserData</a> - explains the purpose and use of light userdata
<li> <a href="../wiki/LuaVersionCompatibility.html" >LuaVersionCompatibility</a> - ensuring that Lua code remains compatible across multiple versions and implementations
<li> <a href="../wiki/UniversallyUniqueIdentifiers.html" >UniversallyUniqueIdentifiers</a> - various ways to created universally unique identifiers (UUID's) in Lua
<li> <a href="../wiki/PlatformDetection.html" >PlatformDetection</a> - detecting the platform from Lua.
<li> <a href="../wiki/TypeIntrospection.html" >TypeIntrospection</a> - determining types of objects at runtime
<li> <a href="../wiki/GotoStatement.html" >GotoStatement</a> - goto statement
<li> <a href="../wiki/MiningLuaCode.html" >MiningLuaCode</a> - content analysis of Lua source code repos
<li> <a href="../wiki/MechanismNotPolicy.html" >MechanismNotPolicy</a> - comments on Lua's "mechanism not policy" design rule
<li> <a href="../wiki/HammingWeight.html" >HammingWeight</a> - test of hamming weight implementations
</UL>
<p>
Comments/Annotations on Other Documents:
<p>
<UL>
<li> <a href="../wiki/LuaReferenceManualComments.html" >LuaReferenceManualComments</a>
<li> <a href="../wiki/ProgrammingInLuaComments.html" >ProgrammingInLuaComments</a>
<li> <a href="../wiki/LuaSource.html" >LuaSource</a>
<li> <a href="../wiki/WikiStructure.html" >WikiStructure</a>
</UL>
<p>
<H2>Lua 5.3 Wishlist</H2>
<p>
Here are few things bug me, though I'm not necessarily sure what to do about all of them.
<p>
<UL>
<li> Tracebacks might use some reform.
<UL>
<li> Refactoring <code>f(...)</code> to <code>local ok, err = pcall(f, ...); if not ok then error(err) end</code> or <code>assert(pcall(f, ...))</code> has side-effects in traceback behavior.  <a href="/lists/lua-l/2012-02/msg00858.html">LuaList:2012-02/msg00858.html</a>
<li> other older more general comments: <a href="/lists/lua-l/2010-08/msg00481.html">LuaList:2010-08/msg00481.html</a>
<li> Why truncate paths in tracebacks? <a href="/lists/lua-l/2006-03/msg00101.html">LuaList:2006-03/msg00101.html</a>
<li> The <code>level</code> parameter used in the <code>error</code> function lacks maintainability since a function might be called from different levels and those levels might be refactored.  Refactoring <code>f()</code> to <code>(function() return f() end)()</code> has side-effects in terms of level behavior, with no option to suppress the change in stack level.  <a href="../wiki/LuaCarp.html" >LuaCarp</a> was a very early effort to improve this. Also see <a href="/lists/lua-l/2010-01/msg01255.html">[6]</a><a href="/lists/lua-l/2009-09/msg00437.html">[7]</a>.  At least in 5.2 work, getfenv/setfenv are mostly removed and setfenv behavior in module is deprecated, so it's moving in the right direction.
<li> The <code>assert</code> function is arguably misnamed: <a href="/lists/lua-l/2010-05/msg00438.html">[8]</a>.  Also, the fail expression is always evaluated.
</UL>
<li> I have qualms about metamethods.  Despite their uses, they make semantics more complicated.
<UL>
<li> Proliferation of raw v.s. nonraw functions and semantics.  Also, where's "rawtostring"? [<a href="../wiki/LuaFiveTwo.html" >LuaFiveTwo</a>].
<li> I don't get why the change was made in 5.2 table.* functions to partly honor metamethods.  <a href="/lists/lua-l/2010-12/msg00653.html">[9]</a><a href="/lists/lua-l/2011-11/msg01003.html">[10]</a><a href="/lists/lua-l/2011-11/msg00992.html">[11]</a>
<li> __index (unlike the proposed __getindex) doesn't fully intercept table accesses (hence proxy tables).
<li> There were proposals to allow 'a:b()' not to depend on 'a.b' (e.g. __mcall or __mindex metamethod) <a href="/lists/lua-l/2009-06/msg00394.html">[12]</a>
</UL>
<li> <a href="../wiki/NamedParameters.html" >NamedParameters</a> as tables seem heavy.  What effect does it have on <a href="../wiki/LuaJit.html" >LuaJit</a> optimizations?  Converting a function from non-named to named parameters is a fundamental change to its interface, not to be taken lightly.
<li> Questions remain about versioning.  <a href="../wiki/ModuleVersioning.html" >ModuleVersioning</a>/<a href="../wiki/LuaVersionCompatibility.html" >LuaVersionCompatibility</a>.  5.2 is a breaking change and not fully supported in <a href="../wiki/LuaJit.html" >LuaJit</a>.  Other languages like Perl 6 have statements like "use v6;" to indicate the code is Perl6 rather than Perl 5.  <code>_ENV = require '_G53'</code>?
<li> Lua syntax is not always necessarily ideal as a DSL.  Consider representing something like PHP, where control structures are embedded inside tree nodes, but <a href="../wiki/StatementsInExpressions.html" >StatementsInExpressions</a> are not seamless in Lua.  Lua commas can also clutter <a href="/lists/lua-l/2012-03/msg00032.html">[13]</a>.  Compare to Lisp s-expressions or Ocaml.
<li> Cleanup on scope exit (<a href="../wiki/ResourceAcquisitionIsInitialization.html" >ResourceAcquisitionIsInitialization</a>).  The prototypical example involves file handles, like in file_slurp readfile <a href="https://gist.github.com/1325400">[3]</a>.  One of the simpler solutions is a Google Go "defer" or D language "scope(exit).
<li> <code>local ok, err = f(); if not ok then return ok, err end</code> is a common idiom.  Should it be made shorter?
<li> <a href="../wiki/StringInterpolation.html" >StringInterpolation</a> for local variables has no really nice solution.  Some type of compile-time preprocessing step that expands things like <code>printf "${x},${y},${x}"</code> into <code>printf("${x},${y},${x}", x, y, x)</code> that is then evaluated at runtime might be a good compromise.
<li> Forwardly declared local functions look instead like global definitions.  Commenting or semantic editors may help some though:
</UL><DL>
<DL>
<dt><dd><pre class="code">
<span class="keyword">local</span> two

<span class="keyword">local</span> <span class="keyword">function</span> one() two() <span class="keyword">end</span>

<span class="keyword">function</span> two() one() <span class="keyword">end</span> <span class="comment">-- forward declared local (misleadingly looks like global)</span>

</pre>

</DL>
</DL><UL>
<li> <code>package.path</code> and <code>package.cpath</code> are strings rather than arrays.  <a href="/lists/lua-l/2010-06/msg00214.html">LuaList:2010-06/msg00214.html</a> .  This led to the "lib" module <a href="https://gist.github.com/1342319">[4]</a>.
<li> Debugging info lacks character positions (only has line numbers): <a href="/lists/lua-l/2010-08/msg00273.html">LuaList:2010-08/msg00273.html</a>
<li> luac with multiple files could be generalized: <a href="/lists/lua-l/2010-11/msg00898.html">LuaList:2010-11/msg00898.html</a>
<li> Lack of comments in the Lua source <a href="/lists/lua-l/2010-06/msg00477.html">[14]</a> (<a href="../wiki/LuaSource.html" >LuaSource</a>) can make it more difficult to penetrate than otherwise.  See <a href="../wiki/LuaAnnotate.html" >LuaAnnotate</a> though.
<li> <code>for _,v in ipairs(t) do</code> is ugly, and it's less efficient than <code>for i=1,#t do local v=t[i] do</code>.  The too forms do noth have the same behavior either in terms of <code>__len</code>.
</UL>
<p>
<H2>Lua 5.2 Wishlist</H2>
<p>
Caveat: The below list may not be entirely updated to reflect the final 5.2.0 release and may need cleaned up more.
<p>
These changes I want are included in the 5.2 work releases (<a href="../wiki/LuaFiveTwo.html" >LuaFiveTwo</a>):
<p>
<UL>
<li> <strong>Module system reforms</strong> - Make the module system more consistent - see <a href="../wiki/LuaModuleFunctionCritiqued.html" >LuaModuleFunctionCritiqued</a>.  5.2 now deprecates the module function and its ilk.  Some wanted to improve rather than dispose of the module functions, but there was not consensus on precisely what that would be.
<li> <strong>Environment reforms</strong> - I support the _ENV proposal because of the simplifications it makes to lexical analysis (<a href="../wiki/LuaInspect.html" >LuaInspect</a>, <a href="../wiki/LuaFish.html" >LuaFish</a>/luaanalyze) and compilation (<a href="../wiki/LuaToCee.html" >LuaToCee</a>).  I think this is related to a more general problem though involving stack levels (see traceback points above).  I agree though that _ENV is ugly and probably should not be used by most user code.
<li> <strong>C function improvements</strong> -- Unlike lua_cpcall, avoid allocation in C functions <a href="/lists/lua-l/2009-08/msg00001.html">[15]</a> (for performance and avoiding complications in error handling) and support multiple arguments and return values in protected calls.  In <a href="../wiki/LuaFiveTwo.html" >LuaFiveTwo</a>, lua_cpcall is eliminated and replaced with a lua_pushcfunction that no longer allocates, and multiple arguments and return values are supported via lua_pcall.
<li> <strong>Lua function caching</strong> - There is now less need to manually hoist function instantiation out of inner loops since functions are now cached.  However, this feature might not be implemented to its full potential<a href="/lists/lua-l/2010-09/msg00492.html">[16]</a>.
<li> <strong><a href="../wiki/BitwiseOperators.html" >BitwiseOperators</a></strong> standard library.  5.2 implements this now.  I had thought the Lua community had already converged on Lua Bit<code></code>Op (supported by Lua<code></code>JIT and superseding lbitlib).  See <a href="../wiki/BitwiseOperators.html" >BitwiseOperators</a>/<a href="http://lua-users.org/lists/lua-l/2010-01/msg00290.html">[5]</a>  Both the 5.2 and LuaJIT bit libraries are probably fine for most purposes, and it can be possible to write code that is compatible with both: `local band = bit.band or bit32.band` provided you avoid incompatible cases.  Should get/set bitfield operations be added? <a href="/lists/lua-l/2010-11/msg00669.html">[17]</a>
<li> <strong>__len metamethod for tables</strong> (as well as __pairs -- <a href="../wiki/GeneralizedPairsAndIpairs.html" >GeneralizedPairsAndIpairs</a>).  This causes me some hesitation though because of the questions it opens.  Should we have a rawlen (similar to lua_rawlen in the work version)?  Why should pairs() observe metamethods but not next()?  Lua tables remain not truly virtualizable (<a href="../wiki/LuaVirtualization.html" >LuaVirtualization</a>). Should "table" functions recognize metamethods?--probably not <a href="/lists/lua-l/2009-01/msg00001.html">[18]</a>.
<li> <strong>Expose all Lua operations to C API</strong> - Extend C API to support missing operators <a href="/lists/lua-l/2009-06/msg00418.html">[19]</a>.  <a href="../wiki/LuaFiveTwo.html" >LuaFiveTwo</a> now supports lua_compare and lua_arith.  My main motivation for this is to simplify my <a href="../wiki/LuaToCee.html" >LuaToCee</a> output.  Also it makes things orthogonal and is relatively easy for Lua to implement.  Some things may remain lacking like tail calls in C functions <a href="/lists/lua-l/2010-09/msg00003.html">[20]</a>.
<li> <strong>Hex escapes in strings</strong> are sometimes nice (avoiding conversion to decimal), particularly when reading files or communications streams whose specification includes bytes in hex format or whose individual bits have significance.  Sure, you can use a helper function, <code>hex 'cdef'</code> or <code>binary '0101'</code>, but why need that.
<li> Some ask for <a href="../wiki/ContinueProposal.html" >ContinueProposal</a>.  I tend to find breaking out of nested loops more common.  Here's my proposal that generalizes nested break+continue into a single construct: <a href="/lists/lua-l/2010-11/msg00556.html">LuaList:2010-11/msg00556.html</a> .  See also <a href="../wiki/GotoStatement.html" >GotoStatement</a>.
<li> <strong>Minor odds and ends</strong>:
<UL>
<li> closing a pipe returns exit status
<li> Protect against triggering undefined behavior in C libraries from Lua standard libraries <a href="/lists/lua-l/2007-04/msg00511.html">[21]</a> like <code>os.date</code>.  IMO, the standard library (except maybe debug) should never crash on bad input.
<li> Rename lua_typerror to lua_typeerror <a href="/lists/lua-l/2010-05/msg00560.html">[22]</a>.  Actually, the function is now deprecated instead.
<li> "package.loaders" misnomer <a href="/lists/lua-l/2007-10/msg00266.html">[23]</a><a href="/lists/lua-l/2008-02/msg00957.html">[24]</a> (package.loaders contains searchers not loaders).
</UL>
<li> <strong>Other things</strong> I don't often run into but I guess are nice: more freedom to yield (including <a href="../wiki/PcallAndCoroutines.html" >PcallAndCoroutines</a>), xpcall accepting arguments like pcall, non-string error messages in Lua interpreter, emphemeron tables (improves weak table garbage collection).
<li> `luac -l -l` is currently undocumented (done in 5.2.0)
<li> Treat unrecognized escape sequences as errors? <a href="/lists/lua-l/2010-10/msg00449.html">LuaList:2010-10/msg00449.html</a>
<li> Overcome implementation limits in number of locals <a href="/lists/lua-l/2009-06/msg00410.html">[25]</a> and concatenation <a href="../wiki/AssociativityOfConcatenation.html" >AssociativityOfConcatenation</a> is not done, but <a href="../wiki/LuaFiveTwo.html" >LuaFiveTwo</a> is increasing "Maximum number of constants per chunk increased to 2^26 from 2^18" though.
</UL>
<p>
Here's other older ideas not addressed in 5.2 and which I haven't decided to move them up to the 5.3 wishlist:
<p>
<UL>
<li> Some type of macro mechanism.  See <a href="../wiki/MetaProgramming.html" >MetaProgramming</a>.
<li> Add efficient tests for existence of operators on objects <a href="/lists/lua-l/2009-05/msg00479.html">[26]</a><a href="/lists/lua-l/2009-06/msg00398.html">[27]</a>
<li> File handle virtualization - Sometimes you can pass a custom table that looks like a file handle to functions that expect a file handle, but this doesn't work all the time (e.g. if the function tests with io.type).
<li> Maybe add versions of lua_pushstring and lua_newuserdata that don't longjump.  May be useful for mixing C++ exception code and C API longjump code.
<li> Small source code changes to reduce patching complexity? <a href="/lists/lua-l/2010-11/msg00899.html">LuaList:2010-11/msg00899.html</a>
<li> Reference manual formatting suggestions: <a href="/lists/lua-l/2010-10/msg00350.html">LuaList:2010-10/msg00350.html</a>
<li> Generalize Lua table constructor notation <a href="/lists/lua-l/2010-11/msg00229.html">[28]</a>.  This also provides list comprehension syntax.
<li> Manipulations with <code>...</code> are somewhat awkward unless you copy it in a table (not as efficient) and handle <code>nil</code>s correctly.  See also <a href="../wiki/VarargTheSecondClassCitizen.html" >VarargTheSecondClassCitizen</a>.  Something like the proposed #... and ...[i] would help, although that particular syntax has problems.  The dilemma is summarized by Roberto here: <a href="/lists/lua-l/2010-06/msg00434.html">LuaList:2010-06/msg00434.html</a>.  Some small improvements are likely possible though.
<li> Abstracted liolib.c <a href="/lists/lua-l/2008-07/msg00390.html">[29]</a> - Many people embed Lua in systems without STDIO (e.g. GUI applications) and patch this file.  Lua 5.2 provides some abstraction for this (e.g. luai_writestring) but it does not cover liolib.c.
<li> Clearer syntax errors <a href="/lists/lua-l/2009-06/msg00349.html">[30]</a><a href="/lists/lua-l/2009-06/msg00380.html">[31]</a><a href="/lists/lua-l/2009-06/msg00381.html">[32]</a>.  Some improvement is possible.  Really good error/warning reporting might require an external linter.
<li> <a href="../wiki/ModuleExecutionProposal.html" >ModuleExecutionProposal</a> - execute Lua command-line scripts located via LUA_PATH
<li> On <strong><a href="../wiki/DetectingUndefinedVariables.html" >DetectingUndefinedVariables</a></strong>, my current opinion is that it is best handled by the text editor.  I find runtime analysis (strict.lua) inferior to static bytecode analysis (globals.lua) inferior to static source analysis (<a href="../wiki/LuaInspect.html" >LuaInspect</a>).  Furthermore globals.lua and the (hybrid) checkglobals don't work as well in 5.2 due to _ENV changes.
<li> <a href="../wiki/ShortAnonymousFunctions.html" >ShortAnonymousFunctions</a> - It's often said that the Lua syntax for anonymous functions can be verbose for tiny functions used in function programming (map/filter) and functions used as blocks (e.g. simulated switch or try/catch statements).  The workarounds in <a href="../wiki/ShortAnonymousFunctions.html" >ShortAnonymousFunctions</a> are not very satisfying.  It doesn't seem like discussions on the user group are seriously going anywhere here though.
<li> Allow pragmas in source to inject debugging info into the bytecode. <a href="/lists/lua-l/2009-05/msg00288.html">[33]</a> (useful for preprocessors of Lua source).  Metalua currently uses its own bytecode generator because of such limitations.  There is a workaround but it is not fully general: <a href="/lists/lua-l/2010-06/msg00311.html">LuaList:2010-06/msg00311.html</a> .  I suspect, however, that rather than injecting debug info, it may be better to just rewrite the message handler.
<li> More efficiently (O(1)) preallocate or subsequently clear arrays.  This may involve both Lua and C API functions like <code>lua_createtable</code> <a href="/lists/lua-l/2009-06/msg00422.html">[34]</a>.  See <a href="../wiki/TablePreallocation.html" >TablePreallocation</a> for the preallocation (does not discuss clearing).
<li> Lua has the dichotomy of statements and expressions (<a href="../wiki/StatementsInExpressions.html" >StatementsInExpressions</a>/<a href="../wiki/ExpressionsAsStatements.html" >ExpressionsAsStatements</a>).  The loophole in this are anonymous functions, but this involves a heap allocation, unless it triggers 5.2 function caching, bug that's not always triggered, and syntax can be verbose (<a href="../wiki/ShortAnonymousFunctions.html" >ShortAnonymousFunctions</a>).  This can be useful in metaprogramming, and Metalua recognizes this (see "Statements in expressions" in the Metalua Manual) and extends the Lua parser/compiler to allow it while requiring no change to the Lua VM.  See also the "let" statements mentioned below on this page and "Stored Expressions" in <a href="../wiki/LuaDesignPatterns.html" >LuaDesignPatterns</a>.  The <a href="../wiki/SourceOptimizer.html" >SourceOptimizer</a> provides an automated way to inline anonymous functions into standard Lua 5.1 source code, but the transformation wasn't straightforward.
<li> The highly dynamic nature of Lua limits its performance.  True, Lua is <em>fast</em>, but it could be <em>faster</em>.  For example, <code>x*x</code> is generally faster than <code>x^2</code> since Lua cannot reduce the latter to the former at compile time (think: <code>x</code> might have a <code>__pow</code> metamethod).  Macro processing could alleviate this (e.g. "transforming "y = SQUARE(x+y) + 1" into "y = (let t1 = x+y in t*t) + 1").  See also LuaJIT and <a href="../wiki/LuaToCee.html" >LuaToCee</a>.  Global, or at least whole-file, flow analysis can help here.
<li> Some other things, not necessary related to Lua core development:
<UL>
<li> Lua needs more standardization of quality control of libraries covering non-ANSI C functionality.  <a href="../wiki/ExtensionProposal.html" >ExtensionProposal</a> and <a href="../wiki/LuaRocks.html" >LuaRocks</a> may help here.  Related concerns involve documentation, testing, and packaging.
<li> Strength access to existing library frameworks in other platforms like .NET, Java, and Python.  Lua acquires the vast resources of these other developer communities.
</UL>
</UL>
<hr>
<a href="../wiki/RecentChanges.html" >RecentChanges</a> &middot; <a href="/cgi-bin/wiki.pl?action=editprefs" >preferences</a><br>
<a href="/cgi-bin/wiki.pl?action=edit&amp;id=DavidManura" >edit</a> &middot; <a href="/cgi-bin/wiki.pl?action=history&amp;id=DavidManura" >history</a><br>Last edited March 9, 2013 9:43 pm GMT <a href="/cgi-bin/wiki.pl?action=browse&amp;diff=1&amp;id=DavidManura" >(diff)</a>
</body>
</html>